<Window x:Class="CopyParametersGadgets.WriteSheetNumberCommand.View.ViewWriteSheetNumber"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:local="clr-namespace:CopyParametersGadgets.WriteSheetNumberCommand.View"
        xmlns:model="clr-namespace:CopyParametersGadgets.Command"
        mc:Ignorable="d"
        Height="500"
        Width="800"
        WindowStyle="ToolWindow"
        BorderThickness="0">
   <Window.Resources>
      <Style TargetType="Button">
         <Style.Resources>
            <Style TargetType="Border">
               <Setter Property="CornerRadius"
                       Value="2" />
               <Setter Property="Margin"
                       Value="0.5" />
            </Style>

         </Style.Resources>
      </Style>
      <Style TargetType="Border">
         <Setter Property="BorderThickness"
                 Value="2" />
         <Setter Property="CornerRadius"
                 Value="6" />
         <Setter Property="BorderBrush"
                 Value="#FFAFC7ED" />
      </Style>
   </Window.Resources>

   <Border Background="#ffffff"
           BorderThickness="5"
           BorderBrush="Transparent"
           CornerRadius="6"
           Padding="0"
           Margin="0">

      <Grid  Background="#FFD3F1E8">

         <Grid.ColumnDefinitions>
            <ColumnDefinition Width="180" />
            <ColumnDefinition />
            <ColumnDefinition />
            <ColumnDefinition Width="80" />
         </Grid.ColumnDefinitions>
         <Grid.RowDefinitions>
            <RowDefinition Height="1" />
            <RowDefinition Height="5*" />
            <RowDefinition Height="1*" />
            <RowDefinition Height="1*" />
         </Grid.RowDefinitions>

         <TabControl Grid.ColumnSpan="4"
                     Background="AliceBlue"
                     Grid.Row="1">

            <TabItem Header="Элементы">
               <Grid>
                  <Grid.ColumnDefinitions>
                     <ColumnDefinition />
                     <ColumnDefinition />
                  </Grid.ColumnDefinitions>

                  <ListBox Grid.RowSpan="2"
                           Grid.Column="0"
                           x:Name="LBCategories"
                           ItemsSource="{Binding Categories}"
                           Background="#7FFFFFFF">
                     <ListBox.ItemTemplate>
                        <DataTemplate>
                           <StackPanel Orientation="Horizontal">
                              <CheckBox IsChecked="{Binding Selected}" />
                              <TextBlock Text="{Binding Category.Name}" />
                           </StackPanel>
                        </DataTemplate>
                     </ListBox.ItemTemplate>
                  </ListBox>

                  <ListBox Grid.Column="1"
                           x:Name="LBParams"
                           SelectionMode="Single"
                           ItemsSource="{Binding AllowedParametersFromSelectedCategories}"
                           DisplayMemberPath="Name"
                           SelectedItem="{Binding ParamForWrite}"
                           Background="#7FFFFFFF">
                  </ListBox>

               </Grid>

            </TabItem>

            <TabItem Header="Листы">
               <Grid>
                  <Grid.ColumnDefinitions>
                     <ColumnDefinition />
                     <ColumnDefinition />
                  </Grid.ColumnDefinitions>

                  <TreeView x:Name="TrVSheets"
                            ItemsSource="{Binding Sheets}"
                            SelectedItemChanged="TrVSheets_SelectedItemChanged"
                            Background="#7FFFFFFF">
                     <TreeView.ItemTemplate>
                        <HierarchicalDataTemplate ItemsSource="{Binding Path=Nodes}">
                           <StackPanel  Orientation="Horizontal"
                                        Margin="1">
                              <CheckBox IsChecked="{Binding Selected}"
                                        VerticalContentAlignment="Center" />
                              <TextBlock Text="{Binding Item.SheetNumber}"
                                         Margin="8,0,0,0" />
                              <TextBlock Text="{Binding Name}"
                                         Margin="8,0,0,0"
                                         TextTrimming="CharacterEllipsis" />
                           </StackPanel>
                        </HierarchicalDataTemplate>
                     </TreeView.ItemTemplate>
                  </TreeView>

                  <TreeView x:Name="TVAvailableParameters"
                            Grid.Column="1"
                            ItemsSource="{Binding ProjectAndSheetParameters}"
                            MouseDoubleClick="TVAvailableParameters_MouseDoubleClick"
                            Background="#7FFFFFFF">
                     <TreeView.ItemTemplate>
                        <HierarchicalDataTemplate ItemsSource="{Binding Path=Nodes}">
                           <StackPanel Orientation="Horizontal"
                                       Margin="1">
                              <TextBlock Text="{Binding Name}" />
                              <TextBlock Text="{Binding Item.Value}"
                                         Margin="10,0,0,0"
                                         Foreground="Gray" />
                           </StackPanel>
                        </HierarchicalDataTemplate>
                     </TreeView.ItemTemplate>
                  </TreeView>
               </Grid>
            </TabItem>

         </TabControl>

         <Button x:Name="Apply"
                 Height="30"
                 VerticalAlignment="Bottom"
                 Margin="3"
                 Grid.Column="3"
                 Grid.Row="3"
                 Content="Вписать"
                 Click="Apply_Click" />

         <Border Grid.Row="2"
                 Grid.RowSpan="2"
                 Background="LightGoldenrodYellow">
            <StackPanel Orientation="Horizontal"
                        HorizontalAlignment="Center">
               <TextBlock Text="{Binding ParamForWrite.Name, Mode=OneWay}"
                          VerticalAlignment="Center" />
               <TextBlock Text=" ="
                          VerticalAlignment="Center" />
            </StackPanel>
         </Border>

         <Border Grid.Row="2"
                 Grid.Column="1"
                 Grid.ColumnSpan="2"
                 Grid.RowSpan="2"
                 Margin="0"
                 Padding="0"
                 Background="LightGoldenrodYellow">
            <ListView ItemsSource="{Binding NewStringParts}">
               <ListView.ItemContainerStyle>
                  <Style TargetType="ListViewItem">
                     <Setter Property="HorizontalContentAlignment"
                             Value="Stretch" />
                  </Style>
               </ListView.ItemContainerStyle>
               <ListView.View>
                  <GridView>
                     <GridViewColumn>
                        <GridViewColumn.Header>
                           <TextBlock Padding="2"
                                      Text="Имя параметра" />
                        </GridViewColumn.Header>
                        <GridViewColumn.CellTemplate>
                           <DataTemplate>
                              <TextBlock Text="{Binding Name }"
                                         MinWidth="40"
                                         MaxWidth="150" />
                           </DataTemplate>
                        </GridViewColumn.CellTemplate>
                     </GridViewColumn>
                     <GridViewColumn>
                        <GridViewColumn.Header>
                           <TextBlock Padding="2"
                                      Text=" Префикс " />
                        </GridViewColumn.Header>
                        <GridViewColumn.CellTemplate>
                           <DataTemplate>
                              <TextBox Text="{Binding Prefix}"
                                       MinWidth="50" />
                           </DataTemplate>
                        </GridViewColumn.CellTemplate>
                     </GridViewColumn>
                     <GridViewColumn>
                        <GridViewColumn.Header>
                           <TextBlock Text="Значение параметра" />
                        </GridViewColumn.Header>
                        <GridViewColumn.CellTemplate>
                           <DataTemplate>
                              <Label  Content="{Binding Value}"
                                      MinWidth="40"
                                      MaxWidth="150"
                                      HorizontalAlignment="Center"
                                      Foreground="Gray" />
                           </DataTemplate>
                        </GridViewColumn.CellTemplate>
                     </GridViewColumn>
                     <GridViewColumn>
                        <GridViewColumn.Header>
                           <TextBlock Text="Суффикс" />
                        </GridViewColumn.Header>
                        <GridViewColumn.CellTemplate>
                           <DataTemplate>
                              <TextBox Text="{Binding Suffix}"
                                       MinWidth="50" />
                           </DataTemplate>
                        </GridViewColumn.CellTemplate>
                     </GridViewColumn>

                     <GridViewColumn Width="40">
                        <GridViewColumn.Header>
                           <TextBlock Text="🔼" />
                        </GridViewColumn.Header>
                        <GridViewColumn.CellTemplate>
                           <DataTemplate>
                              <Button x:Name="MoveUp"
                                      Click="MoveUp_Click"
                                      Width="25"
                                      Height="25">
                                 <Button.Template>
                                    <ControlTemplate>
                                       <Label FontSize="14"
                                              Padding="0"
                                              HorizontalAlignment="Center"
                                              VerticalAlignment="Center"
                                              Content="🔼" />
                                    </ControlTemplate>
                                 </Button.Template>
                              </Button>
                           </DataTemplate>
                        </GridViewColumn.CellTemplate>
                     </GridViewColumn>
                     <GridViewColumn Width="40">
                        <GridViewColumn.Header>
                           <TextBlock Text="❎" />
                        </GridViewColumn.Header>
                        <GridViewColumn.CellTemplate>
                           <DataTemplate>
                              <Button x:Name="Remove"
                                      Click="Remove_Click"
                                      Width="25"
                                      Height="25">
                                 <Button.Template>
                                    <ControlTemplate>
                                       <Label FontSize="14"
                                              Padding="0"
                                              HorizontalAlignment="Center"
                                              VerticalAlignment="Center"
                                              Content="❎" />
                                    </ControlTemplate>
                                 </Button.Template>
                              </Button>
                           </DataTemplate>
                        </GridViewColumn.CellTemplate>
                     </GridViewColumn>
                     <GridViewColumn Width="40">
                        <GridViewColumn.Header>
                           <TextBlock Text="🔽" />
                        </GridViewColumn.Header>
                        <GridViewColumn.CellTemplate>
                           <DataTemplate>
                              <Button x:Name="MoveDown"
                                      Click="MoveDown_Click"
                                      Width="25"
                                      Height="25">
                                 <Button.Template>
                                    <ControlTemplate>
                                       <Label FontSize="14"
                                              Padding="0"
                                              HorizontalAlignment="Center"
                                              VerticalAlignment="Center"
                                              Content="🔽" />
                                    </ControlTemplate>
                                 </Button.Template>
                              </Button>
                           </DataTemplate>
                        </GridViewColumn.CellTemplate>
                     </GridViewColumn>
                  </GridView>
               </ListView.View>
            </ListView>
         </Border>
      </Grid>
   </Border>
</Window>
